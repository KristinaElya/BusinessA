# Документация по подсистеме для нишевых продавцов

---

## Оглавление

- [1. Введение](#введение)
- [2. Описание бизнес-процессов](#описание-бизнес-процессов)
  - [2.1 Регистрация продавца](#регистрация-продавца)
  - [2.2 Создание и редактирование карточек товаров](#создание-и-редактирование-карточек-товаров)
  - [2.3 Управление запасами](#управление-запасами)
  - [2.4 Обработка заказов](#обработка-заказов)
  - [2.5 Взаимодействие с клиентами](#взаимодействие-с-клиентами)
- [3. Заинтересованные стороны](#заинтересованные-стороны)
- [4. Требования к функциональности](#требования-к-функциональности)
  - [4.1 Регистрация и аутентификация](#регистрация-и-аутентификация)
  - [4.2 Управление карточками товаров](#управление-карточками-товаров)
  - [4.3 Управление запасами](#управление-запасами)
  - [4.4 Обработка заказов](#обработка-заказов)
  - [4.5 Взаимодействие с клиентами](#взаимодействие-с-клиентами)
  - [4.6 Аналитика и отчётность](#аналитика-и-отчётность)
- [5. Структура базы данных (БД)](#структура-базы-данных-бд)
- [5.1 Сущности базы данных](#cущности-базы-данных)
- [5.2 Связи между сущностями](#cвязи-между-сущностями)
- [6. Архитектура системы](#архитектура-системы)
- [7. Описание взаимодействия компонентов системы](#описание-взаимодействия-компонентов-системы)

---

## 1. Введение

Документация описывает требования к подсистеме продавцов на платформе маркетплейса, ориентированной на уникальные и хендмейд товары. Она включает в себя ключевые бизнес-процессы, заинтересованные стороны, функциональные требования, структуру базы данных, архитектуру системы и взаимодействие компонентов. Основная задача — обеспечить удобное управление товарами, заказами и взаимодействием с клиентами, а также автоматизировать процессы модерации и аналитики.

Ключевые цели:

- Обеспечить безопасность и качество контента.
- Упростить процесс добавления и редактирования товаров.
- Обеспечить прозрачность и контроль запасов.
- Обеспечить эффективное взаимодействие с покупателями.
- Предоставить аналитические инструменты для продавцов.

---

## 2. Описание бизнес-процессов

### 2.1. Регистрация продавца

1. Продавец заполняет форму регистрации, предоставляя необходимую информацию - имя, email, телефон, описание бизнеса, прикрепляет документы (если требуется).
2. Проверка и одобрение аккаунта продавеца.
3. После одобрения аккаунт становится активным, продавец получает доступ к личному кабинету.

### 2.2. Создание и редактирование карточек товаров

1. Продавец вводит название, описание, добавляет фотографии (несколько изображений), указывает характеристики (цвет, материал, размеры), устанавливает цену.
2. У продавца есть возможность обновлять информацию в любой момент; изменения проходят проверку перед публикацией.
3. Добавляя новый товар, он проходит проверку на соответствие правилам платформы.

### 2.3. Управление запасами

1. При создании или редактировании товара продавец указывает текущий запас.
2. При оформлении заказа количество уменьшается автоматически.
3. Устанавливается лимит на продажу одного товара за раз или ограничение по количеству в день/неделю.
4. Продавец может вручную корректировать запасы в случае поступления новых товаров или списания.

### 2.4. Обработка заказов

1. При новом заказе продавец получает уведомление в интерфейсе или по email.
2. Продавец подтверждает заказ, подготавливает к отправке, меняя статус.
3. После отправки продавец обновляет статус.

### 2.5. Взаимодействие с клиентами

1. Через личный кабинет продавец отвечает на вопросы клиентов или оставленные отзывы.
2. У продавца есть возможность скрывать неподходящие отзывы или жалобы.
3. Продавец может предоставлять дополнительную информацию по запросам клиентов.

---

## 3. Заинтересованные стороны

- **Продавцы**: Основные пользователи системы, реализующие уникальные и хендмейд товары.
- **Клиенты**: Покупатели, осуществляющие заказы на платформе.
- **Администрация платформы**: Команда, обеспечивающая работу платформы и поддержку продавцов.
- **Разработчики**: Инженеры, создающие и поддерживающие подсистему.
- **Маркетолог**: Ответственный за продвижение товаров и стратегию продаж на платформе.

---

## 4. Требования к функциональности

### 4.1. Регистрация и аутентификация

1. Регистрация через форму с подтверждением email.
2. Вход/выход из личного кабинета.
3. Восстановление пароля по email.

### 4.2. Управление карточками товаров

1. Создание новых карточек с обязательными полями: название, описание, фотографии.
2. Возможность добавлять характеристики в виде структурированных данных.
3. Редактирование существующих карточек.
4. Карточки должны проходить проверку модератором или автоматически по правилам платформы.

### 4.3. Управление запасами

1. Указание количества товара при создании/редактировании карточки.
2. Автоматическое уменьшение запаса при оформлении заказа.
3. Возможность устанавливать лимиты на продажу (например: ограниченная серия).
 
### 4.4. Обработка заказов

1. Просмотр списка заказов со статусами ("новый", "в обработке", "отправлен", "завершен", "отменен").
2. Возможность подтверждать или отменять заказы вручную.
3. Обновление статусов заказа через интерфейс или автоматические сценарии.

### 4.5. Взаимодействие с клиентами

1. Ответы на сообщения и отзывы прямо из интерфейса системы.
2. Модерация отзывов (скрытие неподходящих комментариев или жалоб).

### 4.6. Аналитика и отчётность

1. Генерация отчетов о продажах и эффективных товарах.
2. Анализ отзывов и оценок клиентов.

---

## 5. Структура базы данных

### 5.1. Сущности базы данных

- Таблица продавцов

		CREATE TABLE Sellers (
        seller_id SERIAL PRIMARY KEY,
        name VARCHAR(255) NOT NULL,
        email VARCHAR(255) UNIQUE NOT NULL,
        password_hash VARCHAR(255) NOT NULL,
        registration_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        status VARCHAR(50) DEFAULT 'активен'
        );

- Таблица карточек товаров

		CREATE TABLE Products (
        product_id SERIAL PRIMARY KEY,
        seller_id INT REFERENCES Sellers(seller_id),
        title VARCHAR(255) NOT NULL,
        description TEXT,
        images TEXT[],
        characteristics JSONB,
        stock_quantity INT DEFAULT 0,
        price DECIMAL(10,2),
        is_exclusive BOOLEAN DEFAULT FALSE,
        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        status VARCHAR(50) DEFAULT 'на модерации'
        );

- Таблица заказов

		CREATE TABLE Orders (
        order_id SERIAL PRIMARY KEY,
        product_id INT REFERENCES Products(product_id),
        buyer_id INT REFERENCES Buyers(buyer_id),
        quantity INT NOT NULL,
        total_price DECIMAL(10,2),
        status VARCHAR(50) DEFAULT 'новый',
        order_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        update_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP
        );

- Таблица отзывов и сообщений клиентов

		CREATE TABLE CustomerInteractions (
        interaction_id SERIAL PRIMARY KEY,
        product_id INT REFERENCES Products(product_id),
        customer_id INT REFERENCES Buyers(buyer_id),
        message TEXT,
        reply TEXT,
        rating INT CHECK (rating BETWEEN 1 AND 5),
        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        type VARCHAR(50)
        );

### 5.2. Связи между сущностями

В системе реализованы следующие основные связи между сущностями:

- Каждый продавец может создавать и управлять несколькими карточками товаров.
- Каждая карточка товара связана с конкретным продавцом.
- Каждый заказ оформляется одним клиентом.
- Заказ может включать несколько товаров.
- Отзывы и сообщения могут быть связаны либо с конкретным заказом, либо с товаром.
  - Отзыв связан с конкретным товаром (через карточку).
  - Сообщение клиента связано с заказом.
  - Сообщение клиента связано с товаром.

---

## 6. Архитектура системы

Компоненты системы включают в себя:

- **Сервис регистрации и аутентификации**: обрабатывает запросы на регистрацию и вход в систему, управляет сессиями пользователей и токенами доступа. Обеспечивает безопасность с помощью шифрования паролей и двухфакторной аутентификации.
- **Сервис управления товарами**: отвечает за создание и редактирование карточек товаров. Управляет категориями товаров и их атрибутами (например, цена, описание, наличие на складе). Обеспечивает интеграцию с системами управления запасами.
- **Сервис управления заказами**: обрабатывает все операции, связанные с заказами, включая создание, изменение и отмену заказов. Управляет статусами заказов и уведомлениями для пользователей. Обеспечивает интеграцию с платежными системами и логистическими службами.
- **Сервис взаимодействия с клиентами**: управляет сообщениями и отзывами от клиентов. Обеспечивает поддержку через чат, электронную почту и другие каналы связи. Анализирует отзывы для улучшения качества обслуживания и продуктов.

---

## 7. Описание взаимодействия компонентов системы

Каждый компонент взаимодействует через RESTful API.

Пользовательский интерфейс → API слой.
- Продавцы создают/редактируют товары, просматривают заказы и отзывы через веб-интерфейс; все действия идут через API-запросы.

API слой → бизнес логика.
- Обработка запросов — создание новых карточек товаров, изменение запасов, просмотр заказов.

Бизнес логика → база данных.
- Запросы на чтение/запись данных в таблицы `Sellers`, `Products`, `Orders`, `CustomerInteractions`.

Пример взаимодействия:

1. Продавец инициирует запрос на добавление нового товара через сервис управления товарами.
2. Сервис управления товарами обновляет базу данных и отправляет уведомление о создании нового товара.
3. Сервис управления заказами получает уведомление о новом товаре и обновляет соответствующую информацию для клиентов.
4. Клиенты могут оставлять отзывы через сервис взаимодействия с клиентами, который обновляет данные в базе для отображения на странице товара.

---